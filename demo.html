<html>
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta name="description" content="LIRN Online Proxy URL Encoder">
<meta name="viewport" content="width=device-width">
<meta content="text/html;charset=utf-8" http-equiv="Content-Type">
<meta content="utf-8" http-equiv="encoding">
<link rel="stylesheet" href="http://ajax.googleapis.com/ajax/libs/jqueryui/1.10.3/themes/redmond/jquery-ui.css" type="text/css">
<style>
#encoder input { width:80%; margin:0.5em;}
span.ui-icon { display: inline-block; }
</style>
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.10.1/jquery.min.js"></script>
<script src="//ajax.googleapis.com/ajax/libs/jqueryui/1.10.3/jquery-ui.js"></script>
<script src="test/URIjs/URI.min.js"></script>
<script src="src/proxyprefix.js"></script>
<script>
$(document).ready( function() {
  var proxy = $('input#proxy_url');
  var resource = $('input#resource_url');
  var prefixed = $('input#prefixed_url');

  $('#encoder').submit( function() { return false; });

  if ( proxy.val() === '' ) {
    proxy.attr( 'placeholder', 'proxy.example.edu' );
  }

  function prefix_url() {
    var anchor = $('<a></a>').attr( 'href', resource.val() );
    if ( proxy.val() ) {
      anchor.ProxyPrefix( { hostnames: new Array( URI( proxy.val() ).hostname() ) } );
    } else {
      anchor.ProxyPrefix( );
    }
    prefixed.val( anchor.attr('href') ).select();
  }

  $('#prefix_resource_url').button({ 
    icons: { primary: "ui-icon-wrench", } 
  }).click( function( event ) {
    prefix_url();
  });

  $('#test_proxied_url').button({ 
    icons: { primary: "ui-icon-extlink", } 
  }).click( function( event ) {
    prefix_url();
    var popup = window.open( prefixed.val(), '_blank', '', '' );
  });

  $('#clear').button({ 
    icons: { primary: "ui-icon-trash", } 
  }).click( function( event ) {
    proxy.val( '' );
    resource.val( '' );
    prefixed.val( '' );
  });
});
</script>
</head>
<body>
<header>
<img src="://lirnimages.appspot.com/images/lirn_logo_48x275.gif" alt="LIRN" />
<h1>LIRN Online Proxy URL Encoder</h1>
</header>
<section>

<form id="encoder">
<label for="proxy_url">Proxy URL</label>
<input id="proxy_url" type="url" placeholder="Enter proxy URL here" />
<br/>
<label for="resource_url">Resource URL</label>
<input id="resource_url" type="url" placeholder="Enter the full URL for the resource here" autofocus />
<br/>
<label for="prefixed_url">Prefixed URL</label>
<input id="prefixed_url" type="url" />
<br/>
<button id="prefix_resource_url">Prefix</button>
<button id="test_proxied_url">Test</button>
<button id="clear">Clear</button>
</form>

</section>

<footer>
<p style="font-size:small;">
Copyright &copy; 2013 <a href="http://www.lirn.net/">Library &amp; and Information Resources Network, Inc.</a>
</p>
</footer>
</body>
</html>
